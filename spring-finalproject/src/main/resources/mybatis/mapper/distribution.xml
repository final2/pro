<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.finalproject.dao.DistributionDao">

	<!-- 거래처 등록 -->
	<insert id="insertClient" parameterType="Client">
		insert into client
		(no, name, isAdmit)
		values
		(myclient_seq.nextval, #{name}, #{isAdmit})
	</insert>
	
	<!-- 거래처 리스트 -->
	<select id="getClients" resultType="Client">
		select
			no,
			name,
			isAdmit
		from
			client
		order by 
			no desc
	</select>
	
	<!-- 번호로 거래처 조회 -->
	<select id="getClientsByNo" parameterType="int" resultType="Client">
		select 
			no,
			name,
			isAdmit
		from 
			client
		where 
			no = #{value}
	</select>
	
	<select id="getClientDetailsByNo" parameterType="int" resultType="ClDetail">
		select
			c.qty			as qty,
			p.name			as "product.name",
			p.client_no		as clientNo
		from
			client_detail c, product p
		where
			c.product_no = p.no
			and c.client_no = #{value}
	</select>
	
	<!-- 거래처 수정 -->
	<update id="updateClient" parameterType="Client">
		update client
			set
				name = #{name},
				isAdmit = #{isAdmit}
		where no = #{no}
	</update> 
	
	<!-- 게시글 총 수 불러오기 -->
	<select id="getTotalClient" resultType="PN">
		select 
			count(*) as boardTotalNo  
		from client
	</select>
	
	<!-- 페이지당 리스트 불러오기 -->
	<select id="getBeginEndClients" parameterType="PN" resultType="Client">
		select
			rank, no as no, name as name, isAdmit as isAdmit
		from (select row_number() OVER(order by no desc) as rank, no, name, isAdmit
			  from client
			  order by rank)
		where rank >= #{beginBoardNo} and rank &lt;= #{endBoardNo}
	</select>
</mapper>